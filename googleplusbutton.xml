<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="Google plus"    
  scrolling="true"> 
	<Require feature="idi"/>
    <Require feature="locked-domain" />
	<Require feature="dynamic-height"/>
	<Require feature="setprefs" />
  </ModulePrefs>
<Content type="html">
<![CDATA[

<style type="text/css">
  /* @group fonts */
@font-face {
        font-family: 'BBVA Web Light';
        src:url('https://sites.google.com/a/bbva.com/sercoeco/web-light.eot');
        src:url('https://sites.google.com/a/bbva.com/sercoeco/web-light.eot?iefix') format("embedded-opentype"),
          url('https://sites.google.com/a/bbva.com/sercoeco/web-light.woff') format("woff"),
          url('https://sites.google.com/a/bbva.com/sercoeco/web-light.ttf') format("truetype"),
          url('https://sites.google.com/a/bbva.com/sercoeco/web-light.svg#BBVA Web Light') format("svg");
        font-style: normal;
        font-weight: normal;
        
      }

  @font-face {
      font-family: 'BBVA Web Book';
      src:url('https://sites.google.com/a/bbva.com/sercoeco/web-book.eot');
      src:url('https://sites.google.com/a/bbva.com/sercoeco/web-book.eot?iefix') format("embedded-opentype"),
      url('https://sites.google.com/a/bbva.com/sercoeco/web-book.woff') format("woff"),
      url('https://sites.google.com/a/bbva.com/sercoeco/web-book.ttf') format("truetype"),
      url('https://sites.google.com/a/bbva.com/sercoeco/web-book.svg?#BBVA Web Book') format("svg");
      font-style: normal;
      font-weight: normal;
    }

@font-face {
  font-family: 'BBVA Web Medium';
  src:url('https://sites.google.com/a/bbva.com/sercoeco/web-medium.eot');
  src:url('https://sites.google.com/a/bbva.com/sercoeco/web-medium.eot?iefix') format("embedded-opentype"),
    url('https://sites.google.com/a/bbva.com/sercoeco/web-medium.woff') format("woff"),
    url('https://sites.google.com/a/bbva.com/sercoeco/web-medium.ttf') format("truetype"),
    url('https://sites.google.com/a/bbva.com/sercoeco/web-medium.svg?#BBVA Web Medium') format("svg");
  font-style: normal;
  font-weight: normal;
}

body, html {
  font-size: 125%;
  background-color: rgb(255, 255, 255);
}

body {
  font-size: 0.5em;
  font-family: Arial,sans-serif;
  color: rgb(0, 76, 153);
  text-align: left;
  line-height: 1;
}
ol, ul {
  list-style: none outside none;
}

.cabeceramenu {
  width: 960px;
  height: 5.1em;
  margin-top: 0px;
  
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border-radius: 5px;
  background: #0079c1;
  background: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAwNzljMSIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDUyOWIiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+');
  background: -moz-linear-gradient(top,  #0079c1 0%, #00529b 100%);
  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#0079c1), color-stop(100%,#00529b));
  background: -webkit-linear-gradient(top,  #0079c1 0%,#00529b 100%);
  background: -o-linear-gradient(top,  #0079c1 0%,#00529b 100%);
  background: -ms-linear-gradient(top,  #0079c1 0%,#00529b 100%);
  background: linear-gradient(to bottom,  #0079c1 0%,#00529b 100%);
  /*
  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#0079c1', endColorstr='#00529b',GradientType=0 );
  */
  position: relative;
  font-family: BBVA Web Light, Arial, sans-serif;
  font-weight: normal;
  text-align: center;
}

.cabeceramenu ul{
  margin:0;
  padding:0;
}

.cabeceramenu ul li.op1,
.cabeceramenu ul li.op2,
.cabeceramenu ul li.op3,
.cabeceramenu ul li.op4,
.cabeceramenu ul li.op5,
.cabeceramenu ul li.op6,
.cabeceramenu ul li.op7{
  float: left;
  text-align: center;
  background: url('https://sites.google.com/a/bbva.com/sercoeco/separador-menu.png?attredirects=0') no-repeat scroll right top transparent;
}

.cabeceramenu ul li.op8{
  float: left;
  text-align: center;
}


.cabeceramenu ul li.exito{
  float: left;
  text-align: center;
  background:none;
  border-bottom-right-radius: 5px;
  border-top-right-radius: 5px;
}

.cabeceramenu ul li.exito span,
.cabeceramenu ul li.exito span:hover {
  border-bottom-right-radius: 5px;
    border-top-right-radius: 5px;
  
}

.cabeceramenu ul li.exito a,
.cabeceramenu ul li.exito a:hover{
margin-left:0px;
border-bottom-right-radius: 5px;
border-top-right-radius: 5px;
}

.cabeceramenu ul li .enlace,
.cabeceramenu ul li .enlace:hover{
  font-size: 1.4em;
  margin-right: 0.071em;
  display: block;
  color: #FFF;
  cursor: pointer;
  height: 3.571em;

}

.cabeceramenu ul li .enlace:hover{
  background-color: #004c99;
}

.cabeceramenu ul li a,
.cabeceramenu ul li a:hover{
  color: #FFF;
  cursor: pointer;
  text-decoration:none;
  font-family: BBVA Web Light, Arial, sans-serif;
  font-size:14px;
  font-style:normal;
  font-weight: bold;
    
}

.cabeceramenu ul li.home {
  width: 81px;
}

.cabeceramenu ul li.trucos{
  width: 165px;
}

.cabeceramenu ul li .enlace span{
  padding-top: 1.286em;
  display: inline-block;
  height: 2em;
}

.cabeceramenu ul li .enlace span img{
margin-top:-19px;
}

.cabeceramenu  ul li.op1 {
  width: 50px;
  border-bottom-left-radius: 5px;
    border-top-left-radius: 5px;
}

.cabeceramenu ul li.op2{
  width: 100px;
}

.cabeceramenu ul li.op3{
  width: 100px;
}

.cabeceramenu ul li.op4{
  width: 100px;
}

.cabeceramenu ul li.op5{
  width: 200px;
}

.cabeceramenu ul li.op6{
  width: 145px;
}
.cabeceramenu ul li.op8{
  width: 150px;
  border-bottom-right-radius: 5px;
    border-top-right-radius: 5px;
}
.cabeceramenu ul li.op7{
  width: 115px;
  
}

.cabeceramenu ul li.op1 a:hover{
  border-bottom-left-radius: 5px;
    border-top-left-radius: 5px;
}

.cabeceramenu ul li.op8 span.enlace:hover{
  border-bottom-right-radius: 5px !important;
    border-top-right-radius: 5px !important;
}

.cabeceramenu  ul li.op1 a{
  background: url('https://sites.google.com/a/bbva.com/sercoeco/ico-spritegraficos24.png?attredirects=0') no-repeat scroll 15px -3150px;
  border-bottom-left-radius: 5px;
    border-top-left-radius: 5px;
}

.bloqueEnlaces {
  text-align: right;
  margin-bottom: 10px;
  margin-right: 5px;
  color: #003F8C;
  font-size: 12px;
  font-family: BBVA Web Book, BBVA Web, Arial, sans-serif;
}

.bloqueEnlaces a.enlaceMenu {
  text-decoration: none;
  color:  #8B9098;
  font-size: 12px;
  font-family: BBVA Web Light, BBVA Web, Arial, sans-serif;
  font-weight: normal;
  
}
.bloqueEnlaces {
  text-align: right;
  margin-bottom: 10px;
  margin-right: 5px;
  color: #003F8C;
  font-size: 12px;
  font-family: BBVA Web Book,  Arial;
}

.bloqueEnlaces a.enlaceMenu {
  text-decoration: none;
  color:  #8B9098;
  font-size: 12px;
  font-family: BBVA Web Light, Arial;
  font-weight: normal;
  
}
</style>
<!--[if IE 8]>
<style type="text/css">
  
  .cabeceramenu {
    background:url('https://sites.google.com/a/bbva.com/sercoeco/backcabeceraHomeIE2.png?attredirects=0');
  
  }




</style>
<![endif]-->


	<body onload="createb()">
		<p id="text"></p>
		<span id="signinButton">
		  <span
		  	id="signp"
		    class="g-signin"
		    data-clientid="xxx"
		    data-callback="signinCallback"
		    data-cookiepolicy="single_host_origin"
		    data-requestvisibleactions="http://schemas.google.com/AddActivity"
		    data-scope="https://www.googleapis.com/auth/userinfo.email">
		  </span>
		</span>
	  
		
      
        <input type="hidden" id="mail"></input>
		
	<div id="insertmenu"></div>	
	</body>




  
    <script src="https://www.google.com/jsapi" type="text/javascript"></script>
    <!--<script src="https://leanobservatory.googlecode.com/svn/trunk/js/common.js"></script>-->
    <title>GetUser</title>
  
  	<script type="text/javascript">
     var mail;
     var martincito;
	console.log("version 13 jor");
  	var entorno;
  	var llave;
	var url = window.location.host;
	var urlparent = gadgets.util.getUrlParameters()["parent"];
	var returnedJSON;
		
		
	llave = "1063639960042.apps.googleusercontent.com";
		 		
	
	
	
	function createb(){
		// 'Getting' data-attributes using getAttribute
		var zombi = document.getElementById('signp');
		//var fruitCount = plant.getAttribute('data-clientid'); // fruitCount = '12'

		// 'Setting' data-attributes using setAttribute
		zombi.setAttribute('data-clientid',llave); // Pesky birds

	  
       var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
       po.src = 'https://apis.google.com/js/client:plusone.js';
       var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    
	}
	
	function newpostReq(url,callBack){
		console.log("entro en function newpostReq (url,callBack)");
		    var xmlhttp;
		    if (window.XDomainRequest)
		    {
		        xmlhttp=new XDomainRequest();
		        xmlhttp.onload = function(){callBack(xmlhttp.responseText)};
		    }
		    else if (window.XMLHttpRequest)
		        xmlhttp=new XMLHttpRequest();
		    else
		        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		    xmlhttp.onreadystatechange=function()
		    {
		        if (xmlhttp.readyState==4 && xmlhttp.status==200)
		            callBack(xmlhttp.responseText);
		    }

		    xmlhttp.open("GET",url,true);
		    xmlhttp.send();
		}
	
  	
  	function signinCallback(authResult) {
	  console.log("entro en signinCallback");
	  console.log("authResult['access_token'] "+authResult['access_token']);
  	    
          if (authResult['access_token']) {
       // Successfully authorized
       // Hide the sign-in button now that the user is authorized, for example:
       document.getElementById('signinButton').setAttribute('style', 'display: none');
  	    
		gapi.client.load('oauth2', 'v2', function() {
			gapi.client.oauth2.userinfo.get().execute(function(resp) {
				// Shows user email
        mail= resp.email;
				martincito = resp.email;           
        document.getElementById("mail").innerHTML = martincito;
			console.log("Log: " + martincito);
			console.log("entro en gapi.client.oauth2.userinfo.get().execute(function(resp)");
			sendQuery(martincito);
            getPermissions();
			})
  		});		
		console.log("martincito "+martincito);	
		var urlaux = "https://script.google.com/a/macros/bbva.com/s/AKfycbyCvKr4gZa9ER4_Q063fbYbK-_NC2l1CUy4EXa-JaIh/dev?email="+martincito+"&url="+urlparent;
		console.log("urlaux "+urlaux);
		newpostReq(urlaux, function(jsonString) {
			returnedJSON = String(jsonString);
			console.log("returnedJSON "+returnedJSON);
		});
      
     console.log("Mail: " + mail);
     console.log("fin");
  }else {
				var html="";
				html +='<div class="bloqueEnlaces">';
				html +='	Español <a target="_parent" href="https://sites.google.com/a/bbva.com/sercoeco/" class="enlaceMenu">| English</a>';
				html +='</div>';
				html +='<div class="cabeceramenu">';
				html +='<ul>';
				html +='<li id="home" class="op1"><a class="enlace" href="https://sites.google.com/a/bbva.com/sercoeco/"   target="_parent"  title="home"/></li>';
				html +='<li id="consumo" class="op2"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/consumo"  target="_parent">Consumo</a></span></span></li>';
				html +='<li id="personal" class="op3"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/personal"  target="_parent">Personal</a></span></span></li>';
                html +='<li id="reciclado" class="op4"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/reciclado"  target="_parent">Reciclado</a></span></span></li>';
				//html +='<li id="factores" class="op5"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/factores-de-conversion"  target="_parent">Factores de conversión</a></span></span></li>';
				//html +='<li id="cambio" class="op6"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/tipo-de-cambio"  target="_parent">Tipo de cambio</a></span></span></li>';
				//html +='<li id="empleados" class="op7"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/empleados"  target="_parent" >Empleados</a></span></span></li>';
				//html +='<li id="admin" class="op8"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/administracion"  target="_parent" >Administración</a></span></span></li>';
				//html +='</ul></div>';
				document.getElementById('insertmenu').innerHTML = html;
				
  
  }
  		  
  	  
  	}
     
     function getPermissions(){
     mail = document.getElementById("mail").innerHTML;
     //alert(mail);
     
     }

  	</script>
    
        
    
  <script src="https://sites.google.com/a/bbva.com/leanobservatory/jquery.js?attredirects=0&d=1" language="JavaScript"></script>
	
<script type="text/javascript">
var gadgetHelper = null;
var urlTable = "https://docs.google.com/a/bbva.com/spreadsheet/ccc?key=0ApZ6EoQT3skrdHd3ck5TVjFwbVo3WmUxQ01PNkZYUUE";
google.load("visualization", "1", {"packages": ["table"]});
function sendQuery(usermail) 
			{
				gadgetHelper = new google.visualization.GadgetHelper();
				var opts = {dataType:'jsonp'};		
				var query = new google.visualization.Query(urlTable, opts);					
			   
				var querytosend = "select * where G like '%usermail%'  ";
				
				query.setQuery(querytosend);			  
				query.send(handleQueryResponse);
				
				
			}

function handleQueryResponse(response) {
	data = response.getDataTable();	
	var filas = data.getNumberOfRows();
	var html = "";
		for(var i=0;i<filas;i++){
		    var permiso = data.getValue(i,1);
			
			if(permiso.indexOf("ADMIN") != -1){
			    html +='<div class="bloqueEnlaces">';
				html +='	Español <a target="_parent" href="https://sites.google.com/a/bbva.com/sercoeco/" class="enlaceMenu">| English</a>';
				html +='</div>';
				html +='<div class="cabeceramenu">';
				html +='<ul>';
				html +='<li id="home" class="op1"><a class="enlace" href="https://sites.google.com/a/bbva.com/sercoeco/"   target="_parent"  title="home"/></li>';
				html +='<li id="consumo" class="op2"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/consumo"  target="_parent">Consumo</a></span></span></li>';
				html +='<li id="personal" class="op3" ><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/personal"  target="_parent">Personal</a></span></span></li>';
                html +='<li id="reciclado" class="op4"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/reciclado"  target="_parent">Reciclado</a></span></span></li>';
				html +='<li id="factores" class="op5"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/factores-de-conversion"  target="_parent">Factores de conversión</a></span></span></li>';
				html +='<li id="cambio" class="op6"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/tipo-de-cambio"  target="_parent">Tipo de cambio</a></span></span></li>';
				html +='<li id="empleados" class="op7"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/empleados"  target="_parent" >Empleados</a></span></span></li>';
				html +='<li id="admin" class="op8"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/administracion"  target="_parent" >Administración</a></span></span></li>';
				html +='</ul></div>';
			}else{
				html +='<div class="bloqueEnlaces">';
				html +='	Español <a target="_parent" href="https://sites.google.com/a/bbva.com/sercoeco/" class="enlaceMenu">| English</a>';
				html +='</div>';
				html +='<div class="cabeceramenu">';
				html +='<ul>';
				html +='<li id="home" class="op1"><a class="enlace" href="https://sites.google.com/a/bbva.com/sercoeco/"   target="_parent"  title="home"/></li>';
				html +='<li id="consumo" class="op2"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/consumo"  target="_parent">Consumo</a></span></span></li>';
				html +='<li id="personal" class="op3" ><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/personal"  target="_parent">Personal</a></span></span></li>';
                html +='<li id="reciclado" class="op4"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/reciclado"  target="_parent">Reciclado</a></span></span></li>';
				//html +='<li id="factores" class="op5"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/factores-de-conversion"  target="_parent">Factores de conversión</a></span></span></li>';
				//html +='<li id="cambio" class="op6"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/tipo-de-cambio"  target="_parent">Tipo de cambio</a></span></span></li>';
				//html +='<li id="empleados" class="op7"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/empleados"  target="_parent" >Empleados</a></span></span></li>';
				//html +='<li id="admin" class="op8"><span class="enlace" tabindex="0"><span><a href="https://sites.google.com/a/bbva.com/sercoeco/home/administracion"  target="_parent" >Administración</a></span></span></li>';
				//html +='</ul></div>';
			
			}
		document.getElementById('insertmenu').innerHTML = html;
		}

}
</script>


 ]]>	
</Content>
</Module>